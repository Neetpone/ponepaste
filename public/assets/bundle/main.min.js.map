{"version":3,"file":"main.min.js","sources":["../../js/dom.js","../../js/tag_input.js","../../js/main.js"],"sourcesContent":["const $ = function(selector) {\n    return document.querySelector(selector);\n};\n\nconst $$ = function(selector) {\n    return document.querySelectorAll(selector) || [];\n};\n\nconst makeEl = function(html) {\n    const template = document.createElement('template');\n\n    template.innerHTML = html.trim();\n\n    return template.content.firstChild;\n};\n\nconst clearEl = function(el) {\n    while (el.firstChild) {\n        el.removeChild(el.firstChild);\n    }\n};\n\nconst toggleEl = function(el) {\n    if (el.classList.contains('is-hidden')) {\n        el.classList.remove('is-hidden');\n    } else {\n        el.classList.add('is-hidden');\n    }\n};\n\nconst escape = function(unsafe) {\n    return unsafe\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\")\n        .replace(/\"/g, \"&quot;\")\n        .replace(/'/g, \"&#039;\");\n}\n\nconst whenReady = function(funcp) {\n    if (document.readyState !== 'loading') {\n        funcp();\n    } else {\n        document.addEventListener('DOMContentLoaded', funcp);\n    }\n}\n\nexport { whenReady, $, $$, makeEl, clearEl, toggleEl, escape };","import { makeEl, escape } from \"./dom\";\n\nclass TagsInput {\n    constructor(element, options = {}) {\n        this.element = element;\n        this.tags = [];\n        this.options = options\n\n        this.maxTags = options.maxTags || 10;\n        this.inputNode = null;\n        this.containerNode = null;\n    }\n\n    attach() {\n        this.element.style.display = 'none';\n\n        this.containerNode = makeEl('<div class=\"tags-input\"></div>');\n        this.inputNode = makeEl('<input class=\"input\" type=\"text\" placeholder=\"10 tags maximum\" value=\"\" />');\n        this.containerNode.appendChild(this.inputNode);\n\n        this.element.parentNode.insertBefore(this.containerNode, this.element.nextSibling);\n\n        /* Load existing tags from input */\n        if (this.element.value) {\n            for (const tag of this.element.value.split(',')) {\n                this.addTag(tag);\n            }\n        }\n\n        /* Handle addition and removal of tags via key-presses */\n        this.containerNode.addEventListener('keydown', this._handleInputKeyUp.bind(this));\n\n        /* Handle deletions by clicking the delete button */\n        this.containerNode.addEventListener('click', this._handleContainerClick.bind(this));\n    }\n\n    detach() {\n        this.tags.clear();\n        this.containerNode.remove();\n        this.element.style.display = 'inline-block';\n    }\n\n    updateHiddenInputValue() {\n        this.element.value = this.tags.join(',');\n    }\n\n    deleteTagNode(node) {\n        this.tags.splice(this.tags.indexOf(node.dataset.value.toLowerCase()), 1);\n        node.remove();\n\n        /* Below the limit? Make sure the input is enabled. */\n        if (this.tags.length < this.maxTags) {\n            this.inputNode.disabled = false;\n        }\n    }\n\n    addTag(tagValue) {\n        tagValue = tagValue.trim();\n\n        /* Tag value is probably not empty and we don't already have the same tag. */\n        if (tagValue !== '' && this.tags.indexOf(tagValue.toLowerCase()) === -1) {\n            this.tags.push(tagValue.toLowerCase());\n\n            this.inputNode.parentNode.insertBefore(\n                makeEl('<span class=\"tag is-info\" data-value=\"' + escape(tagValue) + '\">' + escape(tagValue) + '<span class=\"delete is-small\" /></span>'),\n                this.inputNode\n            );\n\n            /* Too many tags, disable the input for now. */\n            if (this.tags.length >= this.maxTags) {\n                this.inputNode.disabled = true;\n            }\n        }\n    }\n\n    _handleInputKeyUp(evt) {\n        let tagValue = this.inputNode.value;\n\n        if (evt.key === 'Backspace' && tagValue === '') {\n            // Remove the child\n            if (this.inputNode.previousSibling) {\n                this.deleteTagNode(this.inputNode.previousSibling);\n\n                this.updateHiddenInputValue();\n            }\n        } else if (evt.key === ',') {\n            this.addTag(tagValue);\n\n            this.inputNode.value = ''\n            this.updateHiddenInputValue();\n\n            evt.preventDefault();\n        }\n    }\n\n    _handleContainerClick(evt) {\n        if (evt.target && evt.target.classList.contains('delete')) {\n            this.deleteTagNode(evt.target.closest('.tag'));\n            this.updateHiddenInputValue();\n        }\n    }\n}\n\nexport { TagsInput };\n","import { whenReady, $, $$, toggleEl } from './dom';\nimport { TagsInput } from \"./tag_input\";\n\nconst setupSignupModal = () => {\n    const signupButton = $('[data-target~=\"#signin\"],[data-target~=\"#signup\"]');\n\n    if (signupButton) {\n        signupButton.addEventListener('click', () => {\n            $('.modal').classList.add('is-active');\n        });\n\n        $('.modal-button-close').addEventListener('click', () => {\n            $('.modal').classList.remove('is-active');\n        });\n    }\n}\n\nwhenReady(() => {\n    Array.prototype.forEach.call($$('.js-tag-input'), (el) => {\n        new TagsInput(el).attach();\n    });\n\n    setupSignupModal();\n\n    const embedButton = $('.panel-tools .embed-tool');\n\n    if (embedButton){\n        embedButton.addEventListener('click', (evt) => {\n            if (evt.target && evt.target.closest('.panel-tools')) {\n                toggleEl(evt.target.closest('.panel-tools').querySelector('.panel-embed'));\n            }\n        });\n    }\n\n    const expandButton = $('.expand-tool');\n\n    if (expandButton) {\n        expandButton.addEventListener('click', (evt) => {\n            if (evt.target && evt.target.closest('.panel')) {\n                const panel = evt.target.closest('.panel');\n\n                if (panel.classList.contains('panel-fullsize')) {\n                    panel.classList.remove('panel-fullsize');\n                } else {\n                    panel.classList.add('panel-fullsize');\n                }\n            }\n        });\n    }\n});\n"],"names":["funcp","$","selector","document","querySelector","makeEl","html","template","createElement","innerHTML","trim","content","firstChild","escape","unsafe","replace","TagsInput","element","options","tags","maxTags","inputNode","containerNode","style","display","appendChild","this","parentNode","insertBefore","nextSibling","value","split","tag","addTag","addEventListener","_handleInputKeyUp","bind","_handleContainerClick","clear","remove","join","node","splice","indexOf","dataset","toLowerCase","length","disabled","tagValue","push","evt","key","previousSibling","deleteTagNode","updateHiddenInputValue","preventDefault","target","classList","contains","closest","signupButton","Array","prototype","forEach","call","querySelectorAll","el","attach","add","embedButton","expandButton","panel","readyState"],"mappings":"wxCAAA,IAuC2BA,EAvCrBC,EAAI,SAASC,UACRC,SAASC,cAAcF,IAO5BG,EAAS,SAASC,OACdC,EAAWJ,SAASK,cAAc,mBAExCD,EAASE,UAAYH,EAAKI,OAEnBH,EAASI,QAAQC,YAiBtBC,EAAS,SAASC,UACbA,EACFC,QAAQ,KAAM,SACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,UACdA,QAAQ,KAAM,WClCjBC,wBACUC,OAASC,yDAAU,kBACtBD,QAAUA,OACVE,KAAO,QACPD,QAAUA,OAEVE,QAAUF,EAAQE,SAAW,QAC7BC,UAAY,UACZC,cAAgB,kDAGzB,mBACSL,QAAQM,MAAMC,QAAU,YAExBF,cAAgBjB,EAAO,uCACvBgB,UAAYhB,EAAO,mFACnBiB,cAAcG,YAAYC,KAAKL,gBAE/BJ,QAAQU,WAAWC,aAAaF,KAAKJ,cAAeI,KAAKT,QAAQY,aAGlEH,KAAKT,QAAQa,MAAO,WACFJ,KAAKT,QAAQa,MAAMC,MAAM,qCAAM,KAAtCC,eACFC,OAAOD,wCAKfV,cAAcY,iBAAiB,UAAWR,KAAKS,kBAAkBC,KAAKV,YAGtEJ,cAAcY,iBAAiB,QAASR,KAAKW,sBAAsBD,KAAKV,6BAGjF,gBACSP,KAAKmB,aACLhB,cAAciB,cACdtB,QAAQM,MAAMC,QAAU,qDAGjC,gBACSP,QAAQa,MAAQJ,KAAKP,KAAKqB,KAAK,kCAGxC,SAAcC,QACLtB,KAAKuB,OAAOhB,KAAKP,KAAKwB,QAAQF,EAAKG,QAAQd,MAAMe,eAAgB,GACtEJ,EAAKF,SAGDb,KAAKP,KAAK2B,OAASpB,KAAKN,eACnBC,UAAU0B,UAAW,yBAIlC,SAAOC,GAIc,MAHjBA,EAAWA,EAAStC,UAGkD,IAA/CgB,KAAKP,KAAKwB,QAAQK,EAASH,sBACzC1B,KAAK8B,KAAKD,EAASH,oBAEnBxB,UAAUM,WAAWC,aACtBvB,EAAO,yCAA2CQ,EAAOmC,GAAY,KAAOnC,EAAOmC,GAAY,2CAC/FtB,KAAKL,WAILK,KAAKP,KAAK2B,QAAUpB,KAAKN,eACpBC,UAAU0B,UAAW,qCAKtC,SAAkBG,OACVF,EAAWtB,KAAKL,UAAUS,MAEd,cAAZoB,EAAIC,KAAoC,KAAbH,EAEvBtB,KAAKL,UAAU+B,uBACVC,cAAc3B,KAAKL,UAAU+B,sBAE7BE,0BAEU,MAAZJ,EAAIC,WACNlB,OAAOe,QAEP3B,UAAUS,MAAQ,QAClBwB,yBAELJ,EAAIK,uDAIZ,SAAsBL,GACdA,EAAIM,QAAUN,EAAIM,OAAOC,UAAUC,SAAS,iBACvCL,cAAcH,EAAIM,OAAOG,QAAQ,cACjCL,+DD3DUtD,EEtBjB,WFbC,IAASE,EEAV0D,EAcNC,MAAMC,UAAUC,QAAQC,MFdR9D,EEcgB,gBFbzBC,SAAS8D,iBAAiB/D,IAAa,KEaI,SAACgE,OAC3ClD,EAAUkD,GAAIC,aAfhBP,EAAe3D,EAAE,wDAGnB2D,EAAa1B,iBAAiB,SAAS,WACnCjC,EAAE,UAAUwD,UAAUW,IAAI,gBAG9BnE,EAAE,uBAAuBiC,iBAAiB,SAAS,WAC/CjC,EAAE,UAAUwD,UAAUlB,OAAO,qBAY/B8B,EAAcpE,EAAE,4BAElBoE,GACAA,EAAYnC,iBAAiB,SAAS,SAACgB,GFL9B,IAASgB,EEMVhB,EAAIM,QAAUN,EAAIM,OAAOG,QAAQ,mBFNvBO,EEODhB,EAAIM,OAAOG,QAAQ,gBAAgBvD,cAAc,iBFN/DqD,UAAUC,SAAS,aACtBQ,EAAGT,UAAUlB,OAAO,aAEpB2B,EAAGT,UAAUW,IAAI,qBEQfE,EAAerE,EAAE,gBAEnBqE,GACAA,EAAapC,iBAAiB,SAAS,SAACgB,MAChCA,EAAIM,QAAUN,EAAIM,OAAOG,QAAQ,UAAW,KACtCY,EAAQrB,EAAIM,OAAOG,QAAQ,UAE7BY,EAAMd,UAAUC,SAAS,kBACzBa,EAAMd,UAAUlB,OAAO,kBAEvBgC,EAAMd,UAAUW,IAAI,uBFJR,YAAxBjE,SAASqE,WACTxE,IAEAG,SAAS+B,iBAAiB,mBAAoBlC"}